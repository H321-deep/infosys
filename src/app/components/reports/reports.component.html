<div class="layout">
  <app-sidebar
    [userName]="authService.currentUser()?.name || ''"
    [isAdmin]="authService.isAdmin()"
  />

  <div class="reports-container">
    <header class="header">
      <div class="header-content">
        <h1>Reports & Export</h1>
        <div class="header-actions">
          <span class="user-info">{{ authService.currentUser()?.name }}</span>
          <button class="btn-secondary" (click)="navigateToWelcome()">Back to Dashboard</button>
          <button class="btn-logout" (click)="authService.logout()">Logout</button>
        </div>
      </div>
    </header>

    <main class="main-content">
      @if (error()) {
        <div class="alert alert-error">{{ error() }}</div>
      }

      @if (success()) {
        <div class="alert alert-success">{{ success() }}</div>
      }

      <div class="reports-grid">
        <div class="report-card">
          <div class="report-icon">ðŸ“Š</div>
          <h2>Inventory Summary</h2>
          <p>Generate a comprehensive summary of your inventory including statistics, low-stock items, and financial overview.</p>
          <div class="report-actions">
            <button class="btn-export" (click)="reportType.set('summary'); exportToCSV()">Export CSV</button>
            <button class="btn-export" (click)="reportType.set('summary'); exportToPDF()">Export PDF</button>
          </div>
        </div>

        <div class="report-card">
          <div class="report-icon">ðŸ“‹</div>
          <h2>Transaction History</h2>
          <p>Export detailed transaction records including purchases, sales, dates, and user information for the selected date range.</p>
          <div class="date-range">
            <label>Date Range</label>
            <div class="date-inputs">
              <input type="date" [(ngModel)]="startDate" />
              <span>to</span>
              <input type="date" [(ngModel)]="endDate" />
            </div>
          </div>
          <div class="report-actions">
            <button class="btn-export" (click)="reportType.set('transactions'); exportToCSV()">Export CSV</button>
            <button class="btn-export" (click)="reportType.set('transactions'); exportToPDF()">Export PDF</button>
          </div>
        </div>

        <div class="report-card">
          <div class="report-icon">ðŸ“¦</div>
          <h2>Products List</h2>
          <p>Export a complete list of all products with their details including SKU, category, stock levels, and pricing.</p>
          <div class="report-actions">
            <button class="btn-export" (click)="reportType.set('products'); exportToCSV()">Export CSV</button>
            <button class="btn-export" (click)="reportType.set('products'); exportToPDF()">Export PDF</button>
          </div>
        </div>
      </div>

      <div class="quick-stats">
        <h2>Quick Statistics</h2>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-label">Total Products</span>
            <span class="stat-value">{{ productService.getProducts().length }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Low Stock Items</span>
            <span class="stat-value">{{ productService.getLowStockProducts().length }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Sales</span>
            <span class="stat-value">${{ transactionService.getTotalSales(startDate(), endDate()).toFixed(2) }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Purchases</span>
            <span class="stat-value">${{ transactionService.getTotalPurchases(startDate(), endDate()).toFixed(2) }}</span>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

