import{o as l}from"./chunk-5ILGNDPG.js";import{k as u,n as a,t as c}from"./chunk-4O2FCN7H.js";var g=class n{constructor(r){this.apiService=r}products=c([]);isLoading=c(!1);error=c(null);loadProducts(r,e,o){this.isLoading.set(!0),this.error.set(null),console.log("\u{1F504} Loading products from API...",{search:r,category:e,lowStock:o}),this.apiService.getProducts(r,e,o).subscribe({next:t=>{console.log("\u2705 Products loaded successfully:",t.length,"products"),this.products.set(t),this.isLoading.set(!1)},error:t=>{console.error("\u274C Error loading products:",t),console.error("Error details:",{status:t.status,statusText:t.statusText,message:t.message,error:t.error}),this.error.set(t.error?.message||"Failed to load products"),this.isLoading.set(!1),this.products.set([])}})}getProducts(){return this.products()}getProductById(r){return this.products().find(e=>e.id===r)}getProductBySku(r){return this.products().find(e=>e.sku===r)}createProduct(r){return new Promise((e,o)=>{this.apiService.createProduct({sku:r.sku,name:r.name,category:r.category,supplier:r.supplier,unitPrice:r.unitPrice,minStockThreshold:r.minStockThreshold}).subscribe({next:t=>{this.loadProducts(),e(t)},error:t=>{console.error("Error creating product:",t),o(t)}})})}updateProduct(r,e){return new Promise((o,t)=>{let s={};e.sku!==void 0&&(s.sku=e.sku),e.name!==void 0&&(s.name=e.name),e.category!==void 0&&(s.category=e.category),e.supplier!==void 0&&(s.supplier=e.supplier),e.unitPrice!==void 0&&(s.unitPrice=e.unitPrice),e.minStockThreshold!==void 0&&(s.minStockThreshold=e.minStockThreshold),this.apiService.updateProduct(r,s).subscribe({next:()=>{this.loadProducts(),o(!0)},error:i=>{console.error("Error updating product:",i),t(i)}})})}deleteProduct(r){return new Promise((e,o)=>{this.apiService.deleteProduct(r).subscribe({next:()=>{this.loadProducts(),e(!0)},error:t=>{console.error("Error deleting product:",t),o(t)}})})}updateStockLevel(r,e,o,t){return new Promise((s,i)=>{this.apiService.updateStockLevel(r,{quantity:e,type:o,notes:t}).subscribe({next:()=>{this.loadProducts(),s(!0)},error:d=>{console.error("Error updating stock:",d),i(d)}})})}getLowStockProducts(){return this.products().filter(r=>r.stockLevel<=r.minStockThreshold)}loadLowStockProducts(){this.isLoading.set(!0),this.error.set(null),this.apiService.getLowStockProducts().subscribe({next:r=>{this.products.set(r),this.isLoading.set(!1)},error:r=>{console.error("Error loading low stock products:",r),this.error.set(r.error?.message||"Failed to load low stock products"),this.isLoading.set(!1),this.products.set(this.products().filter(e=>e.stockLevel<=e.minStockThreshold))}})}searchProducts(r){let e=r.toLowerCase();return this.products().filter(o=>o.name.toLowerCase().includes(e)||o.sku.toLowerCase().includes(e)||o.category.toLowerCase().includes(e)||o.supplier.toLowerCase().includes(e))}refresh(){this.loadProducts()}static \u0275fac=function(e){return new(e||n)(a(l))};static \u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"})};export{g as a};
