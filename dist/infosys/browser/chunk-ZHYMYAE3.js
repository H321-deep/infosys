import{a as F}from"./chunk-VHBSOZCT.js";import{a as j}from"./chunk-5ERIZLI5.js";import{a as W}from"./chunk-DXOYZLMS.js";import{b as A,c as I,f as L,n as N,o as z}from"./chunk-5ILGNDPG.js";import{$ as d,Ba as y,D as m,E as O,Fa as D,L as h,M as b,O as v,P as C,Q as _,R as e,S as t,T as S,V as u,W as P,Y as M,_ as n,aa as g,ia as k,ka as w,na as f,t as p,ta as E,ua as T,z as r}from"./chunk-4O2FCN7H.js";var U=(c,o)=>o.id;function V(c,o){c&1&&(e(0,"tr")(1,"td",27),n(2,"No alerts found"),t()())}function $(c,o){if(c&1&&(e(0,"tr")(1,"td")(2,"div",28),S(3,"span",29),e(4,"div")(5,"strong"),n(6),t(),e(7,"span"),n(8),t()()()(),e(9,"td"),n(10,"Low Stock"),t(),e(11,"td")(12,"span",30),n(13),t()(),e(14,"td"),n(15,"Just now"),t()()),c&2){let i=o.$implicit;r(6),d(i.name),r(2),g("Low stock \xB7 ",i.sku),r(4),M("critical",i.stockLevel===0),r(),g(" ",i.stockLevel===0?"Critical":"Warning"," ")}}function H(c,o){if(c&1&&v(0,$,16,5,"tr",null,U),c&2){let i=P();C(i.filteredAlerts())}}function B(c,o){c&1&&(e(0,"tr")(1,"td",31),n(2,"No transactions found"),t()())}function q(c,o){if(c&1&&(e(0,"tr")(1,"td"),n(2),t(),e(3,"td")(4,"span",32),n(5),t()(),e(6,"td"),n(7),t(),e(8,"td"),n(9),t(),e(10,"td"),n(11),k(12,"date"),t()()),c&2){let i=o.$implicit;r(2),d(i.productName),r(2),M("sale",i.type==="sale"),r(),g(" ",i.type==="sale"?"Sale":"Purchase"," "),r(2),d(i.quantity),r(2),d(i.userName),r(2),d(w(12,7,i.date,"MMM d, HH:mm"))}}function J(c,o){if(c&1&&v(0,q,13,10,"tr",null,U),c&2){let i=P();C(i.filteredTransactions())}}var R=class c{constructor(o,i,a,l,s){this.authService=o;this.apiService=i;this.productService=a;this.transactionService=l;this.router=s}totalProducts=p(0);lowStockCount=p(0);outOfStockCount=p(0);totalSales=p(0);totalPurchases=p(0);isLoading=p(!1);searchTerm=p("");recentAlerts=f(()=>this.productService.getLowStockProducts().slice(0,5));recentTransactions=f(()=>[...this.transactionService.getTransactions()].sort((i,a)=>new Date(a.date).getTime()-new Date(i.date).getTime()).slice(0,6));filteredAlerts=f(()=>{let o=this.searchTerm().trim().toLowerCase();return o?this.recentAlerts().filter(i=>i.name.toLowerCase().includes(o)||i.sku.toLowerCase().includes(o)||i.category.toLowerCase().includes(o)):this.recentAlerts()});filteredTransactions=f(()=>{let o=this.searchTerm().trim().toLowerCase();return o?this.recentTransactions().filter(i=>i.productName.toLowerCase().includes(o)||i.productSku.toLowerCase().includes(o)||i.userName.toLowerCase().includes(o)||i.type.toLowerCase().includes(o)):this.recentTransactions()});ngOnInit(){this.loadStats(),this.productService.loadProducts(),this.transactionService.loadTransactions()}loadStats(){this.isLoading.set(!0);let o=new Date().toISOString().split("T")[0],i=new Date;i.setDate(i.getDate()-30);let a=i.toISOString().split("T")[0];this.apiService.getDashboardStats(a,o).subscribe({next:l=>{this.totalProducts.set(l.totalProducts),this.lowStockCount.set(l.lowStockCount),this.outOfStockCount.set(this.productService.getProducts().filter(s=>s.stockLevel===0).length),this.totalSales.set(l.totalSales),this.totalPurchases.set(l.totalPurchases),this.isLoading.set(!1)},error:l=>{console.error("Error loading dashboard stats:",l);let s=this.productService.getProducts();this.totalProducts.set(s.length),this.lowStockCount.set(this.productService.getLowStockProducts().length),this.outOfStockCount.set(s.filter(x=>x.stockLevel===0).length),this.totalSales.set(this.transactionService.getTotalSales(a,o)),this.totalPurchases.set(this.transactionService.getTotalPurchases(a,o)),this.isLoading.set(!1)}})}navigateToProducts(){this.router.navigate(["/products"])}navigateToTransactions(){this.router.navigate(["/transactions"])}navigateToAlerts(){this.router.navigate(["/alerts"])}logout(){this.authService.logout()}static \u0275fac=function(i){return new(i||c)(m(D),m(z),m(j),m(F),m(y))};static \u0275cmp=O({type:c,selectors:[["app-welcome"]],decls:113,vars:12,consts:[[1,"layout"],[3,"userName","isAdmin"],[1,"welcome-container"],[1,"topbar"],[1,"search-bar"],["type","text","placeholder","Search products, orders...",3,"ngModelChange","ngModel"],[1,"search-icon"],[1,"topbar-actions"],["title","Notifications",1,"icon-btn"],[1,"user-chip"],[1,"user-dot"],[1,"btn-primary",3,"click"],[1,"btn-logout",3,"click"],[1,"main-content"],[1,"dashboard-header"],[1,"stats-grid"],[1,"stat-card","products"],[1,"stat-icon"],[1,"stat-card","alerts"],[1,"stat-card","sales"],[1,"stat-card","employees"],[1,"stat-card","out"],[1,"dashboard-grid"],[1,"panel"],[1,"panel-header"],[1,"link-btn",3,"click"],[1,"panel-table"],["colspan","4",1,"empty"],[1,"cell-product"],[1,"product-dot"],[1,"badge"],["colspan","5",1,"empty"],[1,"pill"]],template:function(i,a){if(i&1&&(e(0,"div",0),S(1,"app-sidebar",1),e(2,"div",2)(3,"header",3)(4,"div",4)(5,"input",5),u("ngModelChange",function(s){return a.searchTerm.set(s)}),t(),e(6,"span",6),n(7,"\u{1F50D}"),t()(),e(8,"div",7)(9,"button",8),n(10,"\u{1F514}"),t(),e(11,"div",9)(12,"span",10),n(13,"\u25CF"),t(),e(14,"span"),n(15),t()(),e(16,"button",11),u("click",function(){return a.navigateToProducts()}),n(17,"+ Add Product"),t(),e(18,"button",12),u("click",function(){return a.logout()}),n(19,"Logout"),t()()(),e(20,"main",13)(21,"div",14)(22,"div")(23,"h1"),n(24,"Dashboard Overview"),t(),e(25,"p"),n(26),t()()(),e(27,"div",15)(28,"div",16)(29,"div",17),n(30,"\u{1F4E6}"),t(),e(31,"div")(32,"p"),n(33,"Total Products"),t(),e(34,"h3"),n(35),t()()(),e(36,"div",18)(37,"div",17),n(38,"\u26A0\uFE0F"),t(),e(39,"div")(40,"p"),n(41,"Low Stock Items"),t(),e(42,"h3"),n(43),t()()(),e(44,"div",19)(45,"div",17),n(46,"\u{1F4C8}"),t(),e(47,"div")(48,"p"),n(49,"Total Stock Value"),t(),e(50,"h3"),n(51),t()()(),e(52,"div",20)(53,"div",17),n(54,"\u{1F465}"),t(),e(55,"div")(56,"p"),n(57,"Active Employees"),t(),e(58,"h3"),n(59),t()()(),e(60,"div",21)(61,"div",17),n(62,"\u26D4"),t(),e(63,"div")(64,"p"),n(65,"Out of Stock"),t(),e(66,"h3"),n(67),t()()()(),e(68,"div",22)(69,"section",23)(70,"div",24)(71,"h2"),n(72,"Recent Alerts"),t(),e(73,"button",25),u("click",function(){return a.navigateToAlerts()}),n(74,"View All"),t()(),e(75,"div",26)(76,"table")(77,"thead")(78,"tr")(79,"th"),n(80,"Product"),t(),e(81,"th"),n(82,"Alert Type"),t(),e(83,"th"),n(84,"Severity"),t(),e(85,"th"),n(86,"Time"),t()()(),e(87,"tbody"),h(88,V,3,0,"tr")(89,H,2,0),t()()()(),e(90,"section",23)(91,"div",24)(92,"h2"),n(93,"Recent Transactions"),t(),e(94,"button",25),u("click",function(){return a.navigateToTransactions()}),n(95,"View All"),t()(),e(96,"div",26)(97,"table")(98,"thead")(99,"tr")(100,"th"),n(101,"Product"),t(),e(102,"th"),n(103,"Type"),t(),e(104,"th"),n(105,"Quantity"),t(),e(106,"th"),n(107,"User"),t(),e(108,"th"),n(109,"Time"),t()()(),e(110,"tbody"),h(111,B,3,0,"tr")(112,J,2,0),t()()()()()()()()),i&2){let l,s,x;r(),_("userName",((l=a.authService.currentUser())==null?null:l.name)||"")("isAdmin",a.authService.isAdmin()),r(4),_("ngModel",a.searchTerm()),r(10),d((s=a.authService.currentUser())==null?null:s.role),r(11),g("Welcome back, ",(x=a.authService.currentUser())==null?null:x.name,". Here's what's happening today."),r(9),d(a.totalProducts()),r(8),d(a.lowStockCount()),r(8),g("$",a.totalPurchases().toFixed(2)),r(8),d(a.authService.isAdmin()?4:1),r(8),d(a.outOfStockCount()),r(21),b(a.filteredAlerts().length===0?88:89),r(23),b(a.filteredTransactions().length===0?111:112)}},dependencies:[T,N,A,I,L,W,E],styles:[".layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;background:#f6f7fb}.welcome-container[_ngcontent-%COMP%]{flex:1;margin-left:var(--sidebar-width, 270px);min-height:100vh;background:#f6f7fb;display:flex;flex-direction:column}@media (max-width: 768px){.welcome-container[_ngcontent-%COMP%]{margin-left:0}}@media (max-width: 1100px){.topbar[_ngcontent-%COMP%]{padding:14px 18px}.search-bar[_ngcontent-%COMP%]{max-width:100%}}.topbar[_ngcontent-%COMP%]{background:#fffffff2;padding:16px 24px;box-shadow:0 2px 10px #00000014;display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;width:100%;box-sizing:border-box}.search-bar[_ngcontent-%COMP%]{position:relative;flex:1 1 280px;max-width:320px;min-width:220px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 36px 10px 14px;border-radius:10px;border:1px solid #e2e8f0;background:#f7f9ff;font-size:13px}.search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#a0aec0;font-size:14px}.topbar-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:flex-end}.icon-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:10px;border:1px solid #e2e8f0;background:#fff;cursor:pointer}.user-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 12px;border-radius:999px;border:1px solid #e2e8f0;font-size:12px;text-transform:capitalize}.user-dot[_ngcontent-%COMP%]{color:#38a169;font-size:10px}.btn-primary[_ngcontent-%COMP%]{padding:10px 16px;border-radius:10px;border:none;background:#4b5eea;color:#fff;font-size:13px;font-weight:600;cursor:pointer}.btn-logout[_ngcontent-%COMP%]{padding:10px 16px;border-radius:10px;border:none;background:#fc8181;color:#fff;font-size:13px;font-weight:600;cursor:pointer}.main-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:28px 24px 36px;flex:1;width:100%}.dashboard-header[_ngcontent-%COMP%]{margin-bottom:20px}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 6px;font-size:24px;color:#2d3748}.dashboard-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:14px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:16px;margin-bottom:28px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:16px;display:flex;gap:12px;align-items:center;box-shadow:0 8px 18px #14245e14;border:1px solid #eef1f8}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:#edf2ff}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:4px 0 0;font-size:22px;color:#2d3748}.stat-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:12px;font-weight:600}.stat-card.alerts[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#fff4e5}.stat-card.sales[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#e8f5ff}.stat-card.employees[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#e9f7ef}.stat-card.out[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#ffe5e5}.dashboard-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}@media (max-width: 1100px){.dashboard-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.panel[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;box-shadow:0 10px 24px #14245e14;border:1px solid #eef1f8}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.panel-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;color:#2d3748}.link-btn[_ngcontent-%COMP%]{border:none;background:transparent;color:#4b5eea;font-size:12px;cursor:pointer}.panel-table[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:520px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:10px 8px;font-size:11px;color:#fff;text-transform:uppercase;border-bottom:1px solid rgba(255,255,255,.35);background:linear-gradient(135deg,#4b5eea,#5a6efb);letter-spacing:.4px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 8px;font-size:12px;color:#2d3748;border-bottom:1px solid #f1f5f9}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background:#f9fbff}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#fff}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#eef2ff}.cell-product[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.cell-product[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block}.cell-product[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;color:#a0aec0;font-size:11px}.product-dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;background:#5a6efb}.badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:999px;background:#fff3dc;color:#c05621;font-size:11px;font-weight:600}.badge.critical[_ngcontent-%COMP%]{background:#ffe3e3;color:#c53030}.pill[_ngcontent-%COMP%]{padding:4px 10px;border-radius:999px;background:#e9edff;font-size:11px;font-weight:600}.pill.sale[_ngcontent-%COMP%]{background:#e6fff7;color:#2c7a7b}.empty[_ngcontent-%COMP%]{text-align:center;color:#a0aec0;padding:20px 0}"]})};export{R as WelcomeComponent};
