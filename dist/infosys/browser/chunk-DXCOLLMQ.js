import{a as R}from"./chunk-VHBSOZCT.js";import{a as j}from"./chunk-5ERIZLI5.js";import{a as F}from"./chunk-DXOYZLMS.js";import{b as A,c as L,f as N,n as z,o as W}from"./chunk-5ILGNDPG.js";import{$ as s,Ba as D,D as x,E as k,Fa as I,L as v,M as S,O as C,P as _,Q as P,R as e,S as t,T as m,V as h,W as M,X as b,Y as O,_ as n,aa as p,ia as w,ka as y,na as f,t as u,ta as E,ua as T,z as r}from"./chunk-4O2FCN7H.js";var U=(c,a)=>a.id;function V(c,a){c&1&&(e(0,"tr")(1,"td",47),n(2,"No alerts found"),t()())}function H(c,a){if(c&1&&(e(0,"tr")(1,"td")(2,"div",48),m(3,"span",49),e(4,"div")(5,"strong"),n(6),t(),e(7,"span"),n(8),t()()()(),e(9,"td"),n(10,"Low Stock"),t(),e(11,"td")(12,"span",50),n(13),t()(),e(14,"td"),n(15,"Just now"),t()()),c&2){let i=a.$implicit;r(6),s(i.name),r(2),p("Low stock \xB7 ",i.sku),r(4),O("critical",i.stockLevel===0),r(),p(" ",i.stockLevel===0?"Critical":"Warning"," ")}}function B(c,a){if(c&1&&C(0,H,16,5,"tr",null,U),c&2){let i=M();_(i.filteredAlerts())}}function q(c,a){c&1&&(e(0,"tr")(1,"td",51),n(2,"No transactions found"),t()())}function J(c,a){if(c&1&&(e(0,"tr")(1,"td"),n(2),t(),e(3,"td")(4,"span",52),n(5),t()(),e(6,"td"),n(7),t(),e(8,"td"),n(9),t(),e(10,"td"),n(11),w(12,"date"),t()()),c&2){let i=a.$implicit;r(2),s(i.productName),r(2),O("sale",i.type==="sale"),r(),p(" ",i.type==="sale"?"Sale":"Purchase"," "),r(2),s(i.quantity),r(2),s(i.userName),r(2),s(y(12,7,i.date,"MMM d, HH:mm"))}}function Q(c,a){if(c&1&&C(0,J,13,10,"tr",null,U),c&2){let i=M();_(i.filteredTransactions())}}var $=class c{constructor(a,i,o,l,d){this.authService=a;this.apiService=i;this.productService=o;this.transactionService=l;this.router=d}totalProducts=u(0);lowStockCount=u(0);outOfStockCount=u(0);totalSales=u(0);totalPurchases=u(0);isLoading=u(!1);searchTerm=u("");recentAlerts=f(()=>this.productService.getLowStockProducts().slice(0,5));recentTransactions=f(()=>[...this.transactionService.getTransactions()].sort((i,o)=>new Date(o.date).getTime()-new Date(i.date).getTime()).slice(0,6));filteredAlerts=f(()=>{let a=this.searchTerm().trim().toLowerCase();return a?this.recentAlerts().filter(i=>i.name.toLowerCase().includes(a)||i.sku.toLowerCase().includes(a)||i.category.toLowerCase().includes(a)):this.recentAlerts()});filteredTransactions=f(()=>{let a=this.searchTerm().trim().toLowerCase();return a?this.recentTransactions().filter(i=>i.productName.toLowerCase().includes(a)||i.productSku.toLowerCase().includes(a)||i.userName.toLowerCase().includes(a)||i.type.toLowerCase().includes(a)):this.recentTransactions()});stockSummary=f(()=>{let a=this.totalProducts(),i=this.outOfStockCount(),o=this.lowStockCount(),l=Math.max(o-i,0),d=Math.max(a-l-i,0),g=Math.max(a,1);return{total:a,available:d,lowStock:l,outOfStock:i,availablePct:Math.round(d/g*100),lowStockPct:Math.round(l/g*100),outOfStockPct:Math.round(i/g*100)}});salesPurchasesSummary=f(()=>{let a=this.totalSales(),i=this.totalPurchases(),o=a+i,l=o>0?o:1;return{sales:a,purchases:i,salesPct:Math.round(a/l*100),purchasesPct:Math.round(i/l*100)}});ngOnInit(){this.loadStats(),this.productService.loadProducts(),this.transactionService.loadTransactions()}loadStats(){this.isLoading.set(!0);let a=new Date().toISOString().split("T")[0],i=new Date;i.setDate(i.getDate()-30);let o=i.toISOString().split("T")[0];this.apiService.getDashboardStats(o,a).subscribe({next:l=>{this.totalProducts.set(l.totalProducts),this.lowStockCount.set(l.lowStockCount),this.outOfStockCount.set(this.productService.getProducts().filter(d=>d.stockLevel===0).length),this.totalSales.set(l.totalSales),this.totalPurchases.set(l.totalPurchases),this.isLoading.set(!1)},error:l=>{console.error("Error loading dashboard stats:",l);let d=this.productService.getProducts();this.totalProducts.set(d.length),this.lowStockCount.set(this.productService.getLowStockProducts().length),this.outOfStockCount.set(d.filter(g=>g.stockLevel===0).length),this.totalSales.set(this.transactionService.getTotalSales(o,a)),this.totalPurchases.set(this.transactionService.getTotalPurchases(o,a)),this.isLoading.set(!1)}})}navigateToProducts(){this.router.navigate(["/products"])}navigateToTransactions(){this.router.navigate(["/transactions"])}navigateToAlerts(){this.router.navigate(["/alerts"])}logout(){this.authService.logout()}static \u0275fac=function(i){return new(i||c)(x(I),x(W),x(j),x(R),x(D))};static \u0275cmp=k({type:c,selectors:[["app-welcome"]],decls:155,vars:27,consts:[[1,"layout"],[3,"userName","isAdmin"],[1,"welcome-container"],[1,"topbar"],[1,"search-bar"],["type","text","placeholder","Search products, orders...",3,"ngModelChange","ngModel"],[1,"search-icon"],[1,"topbar-actions"],["title","Notifications",1,"icon-btn"],[1,"user-chip"],[1,"user-dot"],[1,"btn-primary",3,"click"],[1,"btn-logout",3,"click"],[1,"main-content"],[1,"dashboard-header"],[1,"stats-grid"],[1,"stat-card","products"],[1,"stat-icon"],[1,"stat-card","alerts"],[1,"stat-card","sales"],[1,"stat-card","employees"],[1,"stat-card","out"],[1,"panel","chart-panel"],[1,"panel-header"],[1,"panel-subtitle"],[1,"chart-grid"],[1,"chart-card"],["role","img","aria-label","Stock status breakdown",1,"stacked-bar"],[1,"segment","available"],[1,"segment","low"],[1,"segment","out"],[1,"legend"],[1,"legend-item"],[1,"dot","available"],[1,"dot","low"],[1,"dot","out"],[1,"bar-group"],[1,"bar-row"],[1,"label"],[1,"bar"],[1,"fill","sales"],[1,"value"],[1,"fill","purchases"],[1,"dashboard-grid"],[1,"panel"],[1,"link-btn",3,"click"],[1,"panel-table"],["colspan","4",1,"empty"],[1,"cell-product"],[1,"product-dot"],[1,"badge"],["colspan","5",1,"empty"],[1,"pill"]],template:function(i,o){if(i&1&&(e(0,"div",0),m(1,"app-sidebar",1),e(2,"div",2)(3,"header",3)(4,"div",4)(5,"input",5),h("ngModelChange",function(d){return o.searchTerm.set(d)}),t(),e(6,"span",6),n(7,"\u{1F50D}"),t()(),e(8,"div",7)(9,"button",8),n(10,"\u{1F514}"),t(),e(11,"div",9)(12,"span",10),n(13,"\u25CF"),t(),e(14,"span"),n(15),t()(),e(16,"button",11),h("click",function(){return o.navigateToProducts()}),n(17,"+ Add Product"),t(),e(18,"button",12),h("click",function(){return o.logout()}),n(19,"Logout"),t()()(),e(20,"main",13)(21,"div",14)(22,"div")(23,"h1"),n(24,"Dashboard Overview"),t(),e(25,"p"),n(26),t()()(),e(27,"div",15)(28,"div",16)(29,"div",17),n(30,"\u{1F4E6}"),t(),e(31,"div")(32,"p"),n(33,"Total Products"),t(),e(34,"h3"),n(35),t()()(),e(36,"div",18)(37,"div",17),n(38,"\u26A0\uFE0F"),t(),e(39,"div")(40,"p"),n(41,"Low Stock Items"),t(),e(42,"h3"),n(43),t()()(),e(44,"div",19)(45,"div",17),n(46,"\u{1F4C8}"),t(),e(47,"div")(48,"p"),n(49,"Total Stock Value"),t(),e(50,"h3"),n(51),t()()(),e(52,"div",20)(53,"div",17),n(54,"\u{1F465}"),t(),e(55,"div")(56,"p"),n(57,"Active Employees"),t(),e(58,"h3"),n(59),t()()(),e(60,"div",21)(61,"div",17),n(62,"\u26D4"),t(),e(63,"div")(64,"p"),n(65,"Out of Stock"),t(),e(66,"h3"),n(67),t()()()(),e(68,"section",22)(69,"div",23)(70,"h2"),n(71,"Dashboard Trends"),t(),e(72,"span",24),n(73,"Last 30 days"),t()(),e(74,"div",25)(75,"div",26)(76,"h3"),n(77,"Stock Status"),t(),e(78,"div",27),m(79,"span",28)(80,"span",29)(81,"span",30),t(),e(82,"div",31)(83,"div",32),m(84,"span",33),n(85),t(),e(86,"div",32),m(87,"span",34),n(88),t(),e(89,"div",32),m(90,"span",35),n(91),t()()(),e(92,"div",26)(93,"h3"),n(94,"Sales vs Purchases"),t(),e(95,"div",36)(96,"div",37)(97,"span",38),n(98,"Sales"),t(),e(99,"div",39),m(100,"span",40),t(),e(101,"span",41),n(102),t()(),e(103,"div",37)(104,"span",38),n(105,"Purchases"),t(),e(106,"div",39),m(107,"span",42),t(),e(108,"span",41),n(109),t()()()()()(),e(110,"div",43)(111,"section",44)(112,"div",23)(113,"h2"),n(114,"Recent Alerts"),t(),e(115,"button",45),h("click",function(){return o.navigateToAlerts()}),n(116,"View All"),t()(),e(117,"div",46)(118,"table")(119,"thead")(120,"tr")(121,"th"),n(122,"Product"),t(),e(123,"th"),n(124,"Alert Type"),t(),e(125,"th"),n(126,"Severity"),t(),e(127,"th"),n(128,"Time"),t()()(),e(129,"tbody"),v(130,V,3,0,"tr")(131,B,2,0),t()()()(),e(132,"section",44)(133,"div",23)(134,"h2"),n(135,"Recent Transactions"),t(),e(136,"button",45),h("click",function(){return o.navigateToTransactions()}),n(137,"View All"),t()(),e(138,"div",46)(139,"table")(140,"thead")(141,"tr")(142,"th"),n(143,"Product"),t(),e(144,"th"),n(145,"Type"),t(),e(146,"th"),n(147,"Quantity"),t(),e(148,"th"),n(149,"User"),t(),e(150,"th"),n(151,"Time"),t()()(),e(152,"tbody"),v(153,q,3,0,"tr")(154,Q,2,0),t()()()()()()()()),i&2){let l,d,g;r(),P("userName",((l=o.authService.currentUser())==null?null:l.name)||"")("isAdmin",o.authService.isAdmin()),r(4),P("ngModel",o.searchTerm()),r(10),s((d=o.authService.currentUser())==null?null:d.role),r(11),p("Welcome back, ",(g=o.authService.currentUser())==null?null:g.name,". Here's what's happening today."),r(9),s(o.totalProducts()),r(8),s(o.lowStockCount()),r(8),p("$",o.totalPurchases().toFixed(2)),r(8),s(o.authService.isAdmin()?4:1),r(8),s(o.outOfStockCount()),r(12),b("width",o.stockSummary().availablePct,"%"),r(),b("width",o.stockSummary().lowStockPct,"%"),r(),b("width",o.stockSummary().outOfStockPct,"%"),r(4),p(" Available ",o.stockSummary().available," "),r(3),p(" Low ",o.stockSummary().lowStock," "),r(3),p(" Out ",o.stockSummary().outOfStock," "),r(9),b("width",o.salesPurchasesSummary().salesPct,"%"),r(2),p("$",o.totalSales().toFixed(2)),r(5),b("width",o.salesPurchasesSummary().purchasesPct,"%"),r(2),p("$",o.totalPurchases().toFixed(2)),r(21),S(o.filteredAlerts().length===0?130:131),r(23),S(o.filteredTransactions().length===0?153:154)}},dependencies:[T,z,A,L,N,F,E],styles:[".layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;background:#f6f7fb}.welcome-container[_ngcontent-%COMP%]{flex:1;margin-left:var(--sidebar-width, 270px);min-height:100vh;background:#f6f7fb;display:flex;flex-direction:column}@media (max-width: 768px){.welcome-container[_ngcontent-%COMP%]{margin-left:0}}@media (max-width: 1100px){.topbar[_ngcontent-%COMP%]{padding:14px 18px}.search-bar[_ngcontent-%COMP%]{max-width:100%}}.topbar[_ngcontent-%COMP%]{background:#fffffff2;padding:16px 24px;box-shadow:0 2px 10px #00000014;display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;width:100%;box-sizing:border-box}.search-bar[_ngcontent-%COMP%]{position:relative;flex:1 1 280px;max-width:320px;min-width:220px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 36px 10px 14px;border-radius:10px;border:1px solid #e2e8f0;background:#f7f9ff;font-size:13px}.search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#a0aec0;font-size:14px}.topbar-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:flex-end}.icon-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:10px;border:1px solid #e2e8f0;background:#fff;cursor:pointer}.user-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 12px;border-radius:999px;border:1px solid #e2e8f0;font-size:12px;text-transform:capitalize}.user-dot[_ngcontent-%COMP%]{color:#38a169;font-size:10px}.btn-primary[_ngcontent-%COMP%]{padding:10px 16px;border-radius:10px;border:none;background:#4b5eea;color:#fff;font-size:13px;font-weight:600;cursor:pointer}.btn-logout[_ngcontent-%COMP%]{padding:10px 16px;border-radius:10px;border:none;background:#fc8181;color:#fff;font-size:13px;font-weight:600;cursor:pointer}.main-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:28px 24px 36px;flex:1;width:100%}.dashboard-header[_ngcontent-%COMP%]{margin-bottom:20px}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 6px;font-size:24px;color:#2d3748}.dashboard-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:14px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:16px;margin-bottom:28px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:16px;display:flex;gap:12px;align-items:center;box-shadow:0 8px 18px #14245e14;border:1px solid #eef1f8}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:#edf2ff}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:4px 0 0;font-size:22px;color:#2d3748}.stat-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:12px;font-weight:600}.stat-card.alerts[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#fff4e5}.stat-card.sales[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#e8f5ff}.stat-card.employees[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#e9f7ef}.stat-card.out[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#ffe5e5}.dashboard-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}@media (max-width: 1100px){.dashboard-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.panel[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;box-shadow:0 10px 24px #14245e14;border:1px solid #eef1f8}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.panel-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;color:#2d3748}.panel-subtitle[_ngcontent-%COMP%]{font-size:12px;color:#a0aec0}.link-btn[_ngcontent-%COMP%]{border:none;background:transparent;color:#4b5eea;font-size:12px;cursor:pointer}.panel-table[_ngcontent-%COMP%]{overflow-x:auto}.chart-panel[_ngcontent-%COMP%]{margin-bottom:20px}.chart-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}.chart-card[_ngcontent-%COMP%]{background:#f9fbff;border-radius:14px;padding:16px;border:1px solid #eef1f8}.chart-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;color:#2d3748}.stacked-bar[_ngcontent-%COMP%]{display:flex;height:10px;border-radius:999px;background:#edf2ff;overflow:hidden}.segment[_ngcontent-%COMP%]{height:100%}.segment.available[_ngcontent-%COMP%]{background:#48bb78}.segment.low[_ngcontent-%COMP%]{background:#f6ad55}.segment.out[_ngcontent-%COMP%]{background:#f56565}.legend[_ngcontent-%COMP%]{display:flex;gap:14px;flex-wrap:wrap;margin-top:12px;font-size:12px;color:#718096}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#cbd5f0}.dot.available[_ngcontent-%COMP%]{background:#48bb78}.dot.low[_ngcontent-%COMP%]{background:#f6ad55}.dot.out[_ngcontent-%COMP%]{background:#f56565}.bar-group[_ngcontent-%COMP%]{display:grid;gap:12px}.bar-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 1fr 90px;align-items:center;gap:10px}.bar[_ngcontent-%COMP%]{height:10px;border-radius:999px;background:#edf2ff;overflow:hidden}.fill[_ngcontent-%COMP%]{display:block;height:100%}.fill.sales[_ngcontent-%COMP%]{background:#5a6efb}.fill.purchases[_ngcontent-%COMP%]{background:#63b3ed}.label[_ngcontent-%COMP%]{font-size:12px;color:#718096;font-weight:600}.value[_ngcontent-%COMP%]{font-size:12px;color:#2d3748;text-align:right;font-weight:600}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:520px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:10px 8px;font-size:11px;color:#fff;text-transform:uppercase;border-bottom:1px solid rgba(255,255,255,.35);background:linear-gradient(135deg,#4b5eea,#5a6efb);letter-spacing:.4px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 8px;font-size:12px;color:#2d3748;border-bottom:1px solid #f1f5f9}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background:#f9fbff}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#fff}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#eef2ff}.cell-product[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.cell-product[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block}.cell-product[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;color:#a0aec0;font-size:11px}.product-dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;background:#5a6efb}.badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:999px;background:#fff3dc;color:#c05621;font-size:11px;font-weight:600}.badge.critical[_ngcontent-%COMP%]{background:#ffe3e3;color:#c53030}.pill[_ngcontent-%COMP%]{padding:4px 10px;border-radius:999px;background:#e9edff;font-size:11px;font-weight:600}.pill.sale[_ngcontent-%COMP%]{background:#e6fff7;color:#2c7a7b}.empty[_ngcontent-%COMP%]{text-align:center;color:#a0aec0;padding:20px 0}"]})};export{$ as WelcomeComponent};
