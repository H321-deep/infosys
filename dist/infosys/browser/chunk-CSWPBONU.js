import{a as L}from"./chunk-VHBSOZCT.js";import{a as R}from"./chunk-5ERIZLI5.js";import{a as E}from"./chunk-DXOYZLMS.js";import{b as T,c as k,f as w,n as $}from"./chunk-5ILGNDPG.js";import{$ as g,Ba as O,D as m,E as b,Fa as D,L as h,M as x,Q as v,R as n,S as r,T as M,V as d,W as f,_ as o,aa as _,da as P,ea as C,fa as S,t as p,ua as y,z as c}from"./chunk-4O2FCN7H.js";function I(l,i){if(l&1&&(n(0,"div",10),o(1),r()),l&2){let e=f();c(),g(e.error())}}function N(l,i){if(l&1&&(n(0,"div",11),o(1),r()),l&2){let e=f();c(),g(e.success())}}var F=class l{constructor(i,e,t,s){this.productService=i;this.transactionService=e;this.authService=t;this.router=s}startDate=p("");endDate=p("");reportType=p("summary");error=p("");success=p("");ngOnInit(){let i=new Date,e=new Date;e.setDate(e.getDate()-30),this.endDate.set(i.toISOString().split("T")[0]),this.startDate.set(e.toISOString().split("T")[0])}exportToCSV(){try{let i="",e="";this.reportType()==="summary"?(i=this.generateSummaryCSV(),e=`inventory-summary-${new Date().toISOString().split("T")[0]}.csv`):this.reportType()==="transactions"?(i=this.generateTransactionsCSV(),e=`transactions-${this.startDate()}-to-${this.endDate()}.csv`):this.reportType()==="products"&&(i=this.generateProductsCSV(),e=`products-${new Date().toISOString().split("T")[0]}.csv`);let t=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),a=URL.createObjectURL(t);s.setAttribute("href",a),s.setAttribute("download",e),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),this.success.set("Report exported successfully"),setTimeout(()=>{this.success.set("")},2e3)}catch(i){this.error.set("Failed to export report"),console.error("Export error:",i)}}exportToPDF(){this.error.set("PDF export will open print dialog. For full PDF generation, please install a PDF library like jsPDF.");let i=window.open("","_blank");if(!i){this.error.set("Please allow popups to generate PDF");return}let e="";this.reportType()==="summary"?e=this.generateSummaryHTML():this.reportType()==="transactions"?e=this.generateTransactionsHTML():this.reportType()==="products"&&(e=this.generateProductsHTML()),i.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Inventory Report</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { color: #2d3748; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f7fafc; font-weight: bold; }
          </style>
        </head>
        <body>
          ${e}
        </body>
      </html>
    `),i.document.close(),i.print()}generateSummaryCSV(){let i=this.productService.getProducts(),e=this.transactionService.getTransactionsByDateRange(this.startDate(),this.endDate()),t=this.transactionService.getTotalSales(this.startDate(),this.endDate()),s=this.transactionService.getTotalPurchases(this.startDate(),this.endDate()),a=`Inventory Summary Report
`;return a+=`Date Range: ${this.startDate()} to ${this.endDate()}
`,a+=`Generated: ${new Date().toLocaleString()}

`,a+=`Overall Statistics
`,a+=`Total Products,${i.length}
`,a+=`Total Sales,$${t.toFixed(2)}
`,a+=`Total Purchases,$${s.toFixed(2)}
`,a+=`Net Profit,$${(t-s).toFixed(2)}

`,a+=`Low Stock Products
`,a+=`Name,SKU,Stock Level,Threshold
`,this.productService.getLowStockProducts().forEach(u=>{a+=`"${u.name}",${u.sku},${u.stockLevel},${u.minStockThreshold}
`}),a}generateTransactionsCSV(){let i=this.transactionService.getTransactionsByDateRange(this.startDate(),this.endDate()),e=`Transaction Report
`;return e+=`Date Range: ${this.startDate()} to ${this.endDate()}
`,e+=`Generated: ${new Date().toLocaleString()}

`,e+=`Date,Product Name,SKU,Type,Quantity,Unit Price,Total Amount,User
`,i.forEach(t=>{e+=`"${new Date(t.date).toLocaleString()}","${t.productName}",${t.productSku},${t.type},${t.quantity},$${t.unitPrice.toFixed(2)},$${t.totalAmount.toFixed(2)},"${t.userName}"
`}),e}generateProductsCSV(){let i=this.productService.getProducts(),e=`Products Report
`;return e+=`Generated: ${new Date().toLocaleString()}

`,e+=`Name,SKU,Category,Supplier,Unit Price,Stock Level,Threshold
`,i.forEach(t=>{e+=`"${t.name}",${t.sku},"${t.category}","${t.supplier}",$${t.unitPrice.toFixed(2)},${t.stockLevel},${t.minStockThreshold}
`}),e}generateSummaryHTML(){let i=this.productService.getProducts(),e=this.transactionService.getTotalSales(this.startDate(),this.endDate()),t=this.transactionService.getTotalPurchases(this.startDate(),this.endDate()),s=this.productService.getLowStockProducts();return`
      <h1>Inventory Summary Report</h1>
      <p>Date Range: ${this.startDate()} to ${this.endDate()}</p>
      <p>Generated: ${new Date().toLocaleString()}</p>
      <h2>Statistics</h2>
      <table>
        <tr><th>Total Products</th><td>${i.length}</td></tr>
        <tr><th>Total Sales</th><td>$${e.toFixed(2)}</td></tr>
        <tr><th>Total Purchases</th><td>$${t.toFixed(2)}</td></tr>
        <tr><th>Net Profit</th><td>$${(e-t).toFixed(2)}</td></tr>
      </table>
      <h2>Low Stock Products (${s.length})</h2>
      <table>
        <tr><th>Name</th><th>SKU</th><th>Stock Level</th><th>Threshold</th></tr>
        ${s.map(a=>`<tr><td>${a.name}</td><td>${a.sku}</td><td>${a.stockLevel}</td><td>${a.minStockThreshold}</td></tr>`).join("")}
      </table>
    `}generateTransactionsHTML(){let i=this.transactionService.getTransactionsByDateRange(this.startDate(),this.endDate());return`
      <h1>Transaction Report</h1>
      <p>Date Range: ${this.startDate()} to ${this.endDate()}</p>
      <p>Generated: ${new Date().toLocaleString()}</p>
      <table>
        <tr><th>Date</th><th>Product</th><th>SKU</th><th>Type</th><th>Quantity</th><th>Amount</th><th>User</th></tr>
        ${i.map(e=>`<tr><td>${new Date(e.date).toLocaleString()}</td><td>${e.productName}</td><td>${e.productSku}</td><td>${e.type}</td><td>${e.quantity}</td><td>$${e.totalAmount.toFixed(2)}</td><td>${e.userName}</td></tr>`).join("")}
      </table>
    `}generateProductsHTML(){let i=this.productService.getProducts();return`
      <h1>Products Report</h1>
      <p>Generated: ${new Date().toLocaleString()}</p>
      <table>
        <tr><th>Name</th><th>SKU</th><th>Category</th><th>Stock Level</th><th>Price</th></tr>
        ${i.map(e=>`<tr><td>${e.name}</td><td>${e.sku}</td><td>${e.category}</td><td>${e.stockLevel}</td><td>$${e.unitPrice.toFixed(2)}</td></tr>`).join("")}
      </table>
    `}navigateToWelcome(){this.router.navigate(["/welcome"])}static \u0275fac=function(e){return new(e||l)(m(R),m(L),m(D),m(O))};static \u0275cmp=b({type:l,selectors:[["app-reports"]],decls:86,vars:11,consts:[[1,"layout"],[3,"userName","isAdmin"],[1,"reports-container"],[1,"header"],[1,"header-content"],[1,"header-actions"],[1,"user-info"],[1,"btn-secondary",3,"click"],[1,"btn-logout",3,"click"],[1,"main-content"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"reports-grid"],[1,"report-card"],[1,"report-icon"],[1,"report-actions"],[1,"btn-export",3,"click"],[1,"date-range"],[1,"date-inputs"],["type","date",3,"ngModelChange","ngModel"],[1,"quick-stats"],[1,"stats-grid"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"]],template:function(e,t){if(e&1&&(n(0,"div",0),M(1,"app-sidebar",1),n(2,"div",2)(3,"header",3)(4,"div",4)(5,"h1"),o(6,"Reports & Export"),r(),n(7,"div",5)(8,"span",6),o(9),r(),n(10,"button",7),d("click",function(){return t.navigateToWelcome()}),o(11,"Back to Dashboard"),r(),n(12,"button",8),d("click",function(){return t.authService.logout()}),o(13,"Logout"),r()()()(),n(14,"main",9),h(15,I,2,1,"div",10),h(16,N,2,1,"div",11),n(17,"div",12)(18,"div",13)(19,"div",14),o(20,"\u{1F4CA}"),r(),n(21,"h2"),o(22,"Inventory Summary"),r(),n(23,"p"),o(24,"Generate a comprehensive summary of your inventory including statistics, low-stock items, and financial overview."),r(),n(25,"div",15)(26,"button",16),d("click",function(){return t.reportType.set("summary"),t.exportToCSV()}),o(27,"Export CSV"),r(),n(28,"button",16),d("click",function(){return t.reportType.set("summary"),t.exportToPDF()}),o(29,"Export PDF"),r()()(),n(30,"div",13)(31,"div",14),o(32,"\u{1F4CB}"),r(),n(33,"h2"),o(34,"Transaction History"),r(),n(35,"p"),o(36,"Export detailed transaction records including purchases, sales, dates, and user information for the selected date range."),r(),n(37,"div",17)(38,"label"),o(39,"Date Range"),r(),n(40,"div",18)(41,"input",19),S("ngModelChange",function(a){return C(t.startDate,a)||(t.startDate=a),a}),r(),n(42,"span"),o(43,"to"),r(),n(44,"input",19),S("ngModelChange",function(a){return C(t.endDate,a)||(t.endDate=a),a}),r()()(),n(45,"div",15)(46,"button",16),d("click",function(){return t.reportType.set("transactions"),t.exportToCSV()}),o(47,"Export CSV"),r(),n(48,"button",16),d("click",function(){return t.reportType.set("transactions"),t.exportToPDF()}),o(49,"Export PDF"),r()()(),n(50,"div",13)(51,"div",14),o(52,"\u{1F4E6}"),r(),n(53,"h2"),o(54,"Products List"),r(),n(55,"p"),o(56,"Export a complete list of all products with their details including SKU, category, stock levels, and pricing."),r(),n(57,"div",15)(58,"button",16),d("click",function(){return t.reportType.set("products"),t.exportToCSV()}),o(59,"Export CSV"),r(),n(60,"button",16),d("click",function(){return t.reportType.set("products"),t.exportToPDF()}),o(61,"Export PDF"),r()()()(),n(62,"div",20)(63,"h2"),o(64,"Quick Statistics"),r(),n(65,"div",21)(66,"div",22)(67,"span",23),o(68,"Total Products"),r(),n(69,"span",24),o(70),r()(),n(71,"div",22)(72,"span",23),o(73,"Low Stock Items"),r(),n(74,"span",24),o(75),r()(),n(76,"div",22)(77,"span",23),o(78,"Total Sales"),r(),n(79,"span",24),o(80),r()(),n(81,"div",22)(82,"span",23),o(83,"Total Purchases"),r(),n(84,"span",24),o(85),r()()()()()()()),e&2){let s,a;c(),v("userName",((s=t.authService.currentUser())==null?null:s.name)||"")("isAdmin",t.authService.isAdmin()),c(8),g((a=t.authService.currentUser())==null?null:a.name),c(6),x(t.error()?15:-1),c(),x(t.success()?16:-1),c(25),P("ngModel",t.startDate),c(3),P("ngModel",t.endDate),c(26),g(t.productService.getProducts().length),c(5),g(t.productService.getLowStockProducts().length),c(5),_("$",t.transactionService.getTotalSales(t.startDate(),t.endDate()).toFixed(2)),c(5),_("$",t.transactionService.getTotalPurchases(t.startDate(),t.endDate()).toFixed(2))}},dependencies:[y,$,T,k,w,E],styles:[".layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;background:#f6f7fb}.reports-container[_ngcontent-%COMP%]{flex:1;margin-left:var(--sidebar-width, 270px);min-height:100vh;background:#f6f7fb;display:flex;flex-direction:column}@media (max-width: 768px){.reports-container[_ngcontent-%COMP%]{margin-left:0}}.header[_ngcontent-%COMP%]{background:#fffffff2;padding:20px 0;box-shadow:0 2px 10px #00000014;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:0 24px;display:flex;justify-content:space-between;align-items:center}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:28px;font-weight:700;background:linear-gradient(135deg,#38b2ac,#5a67d8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{color:#718096;font-size:14px;padding-right:12px;border-right:1px solid #e2e8f0;font-weight:500}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{padding:10px 20px;background:#edf2f7;color:#4a5568;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0;transform:translateY(-1px)}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-logout[_ngcontent-%COMP%]{padding:10px 20px;background:#fc8181;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-logout[_ngcontent-%COMP%]:hover{background:#f56565;transform:translateY(-1px)}.main-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:32px 24px}.alert[_ngcontent-%COMP%]{padding:16px 20px;border-radius:12px;margin-bottom:24px;font-weight:500;display:flex;align-items:center;gap:12px;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.alert.alert-error[_ngcontent-%COMP%]{background:#fed7d7;color:#c53030;border-left:4px solid #fc8181}.alert.alert-success[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d;border-left:4px solid #48bb78}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.reports-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:24px;margin-bottom:32px}@media (max-width: 1100px){.reports-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.report-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:32px;box-shadow:0 10px 24px #14245e14;border:1px solid #eef1f8;transition:all .3s}.report-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 30px #14245e1f}.report-card[_ngcontent-%COMP%]   .report-icon[_ngcontent-%COMP%]{font-size:34px;margin-bottom:18px;width:54px;height:54px;border-radius:16px;display:grid;place-items:center;background:#edf2ff}.report-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 12px;color:#2d3748;font-size:22px;font-weight:700}.report-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;color:#718096;font-size:14px;line-height:1.6}.report-card[_ngcontent-%COMP%]   .date-range[_ngcontent-%COMP%]{margin-bottom:24px}.report-card[_ngcontent-%COMP%]   .date-range[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#4a5568;font-weight:600;font-size:14px}.report-card[_ngcontent-%COMP%]   .date-range[_ngcontent-%COMP%]   .date-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.report-card[_ngcontent-%COMP%]   .date-range[_ngcontent-%COMP%]   .date-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:10px 12px;border:2px solid #e2e8f0;border-radius:8px;font-size:14px;transition:all .2s}.report-card[_ngcontent-%COMP%]   .date-range[_ngcontent-%COMP%]   .date-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#5a67d8;box-shadow:0 0 0 3px #5a67d81a}.report-card[_ngcontent-%COMP%]   .date-range[_ngcontent-%COMP%]   .date-inputs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#718096;font-weight:500}.report-card[_ngcontent-%COMP%]   .report-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.report-card[_ngcontent-%COMP%]   .report-actions[_ngcontent-%COMP%]   .btn-export[_ngcontent-%COMP%]{flex:1;min-width:120px;padding:12px 20px;background:linear-gradient(135deg,#4b5eea,#5a6efb);color:#fff;border:none;border-radius:10px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s;box-shadow:0 8px 16px #5066ee40}.report-card[_ngcontent-%COMP%]   .report-actions[_ngcontent-%COMP%]   .btn-export[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #5a67d84d}.quick-stats[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:32px;box-shadow:0 2px 12px #00000014}.quick-stats[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 24px;color:#2d3748;font-size:24px;font-weight:700}.quick-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:24px}.quick-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{padding:20px;background:#f7fafc;border-radius:12px;display:flex;flex-direction:column;gap:8px}.quick-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#718096;font-size:13px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.quick-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#2d3748;font-size:28px;font-weight:700}"]})};export{F as ReportsComponent};
